{% extends "samples/base.html" %}

{% load cloudinary %}

{% block title %}{{ course_display_name }} Course Samples - Samplepedia{% endblock %}

{% block content %}

<section class="content-header">
  <div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center">
      <h1>{{ course_display_name }} Course Samples</h1>
    </div>
  </div>
</section>

<section class="content">
  <div class="container-fluid">

    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Samples by Section</h3>
        <div class="card-tools">
          <span class="badge badge-info">{{ sample_data|length }} sample{{ sample_data|length|pluralize }}</span>
        </div>
      </div>

      <div class="card-body p-0">
        {% if sample_data %}
          <table class="table table-striped table-hover text-nowrap table-sm">
            <thead>
              <tr>
                <th style="width: 80px;">Section</th>
                <th style="width: 200px;">Title</th>
                <th>SHA256</th>
                <th>Tags</th>
                <th>Goal</th>
                <th style="width: 80px; text-align: center;">Download</th>
              </tr>
            </thead>
            <tbody>
              {% for item in sample_data %}
              <tr>
                <!-- Section -->
                <td>
                  <span class="badge badge-secondary">{{ item.section }}</span>
                </td>
                
                <!-- Lecture Title -->
                <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="{{ item.lecture_title }}">
                  <a href="{% url 'sample_detail' item.sample.sha256 item.sample.id %}" class="text-muted">
                    <small>{{ item.lecture_title|truncatechars:40 }}</small>
                  </a>
                </td>

                <!-- Sample SHA256 -->
                <td style="max-width: 200px; padding: 0.3rem 0.75rem;">
                  <a href="{% url 'sample_detail' item.sample.sha256 item.sample.id %}" class="d-flex align-items-center" style="min-width: 0;">
                    <code style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap; min-width: 0;" title="{{ item.sample.sha256 }}">{{ item.sample.sha256 }}</code>
                  </a>
                </td>

                <!-- Tags -->
                <td>
                  {% for tag in item.sample.tags.all %}
                    <a href="/?tag={{ tag.name|urlencode }}" class="badge badge-tag">
                      {{ tag.name }}
                    </a>
                  {% empty %}
                    <span class="text-muted">—</span>
                  {% endfor %}
                </td>

                <!-- Goal -->
                <td style="max-width: 250px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                  <a href="{% url 'sample_detail' item.sample.sha256 item.sample.id %}" class="text-muted">
                    <small>{{ item.sample.goal|truncatechars:80 }}</small>
                  </a>
                </td>

                  <!-- Download -->
                <td style="text-align: center;">
                  {% if item.sample.download_link %}
                    <a href="{{ item.sample.download_link }}" target="_blank" class="btn btn-xs btn-primary" title="Download sample">
                      <i class="fas fa-download"></i>
                    </a>
                  {% else %}
                    <span class="text-muted">—</span>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <div class="p-4 text-center">
            <p class="text-muted">No samples found for this course yet.</p>
          </div>
        {% endif %}
      </div>
    </div>
    <button onclick="history.back()" class="btn-back mt-2">
  ← Back to courses
  </button>
  </div>
</section>

{% endblock %}
